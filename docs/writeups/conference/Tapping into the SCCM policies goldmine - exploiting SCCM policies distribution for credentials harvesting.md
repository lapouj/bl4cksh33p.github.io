
_Quentin Roland (SynAcktiv)_

Après une brève introduction sur SCCM et son rôle dans les environnements Active Directory, l’orateur met en lumière une surface d’attaque souvent négligée : les politiques SCCM.

Il rappelle que SCCM, solution historique de gestion de parc, repose sur des agents qui appliquent des configurations appelées « _policies »_. Ces politiques, bien que conçues pour faciliter l’administration, peuvent contenir des secrets, parfois très sensibles. Le cas emblématique est celui du « _Network Access Account »_ : censé être un compte faiblement privilégié, il s’avère parfois disposer de droits bien plus étendus qu’attendu.

L’orateur explore ensuite d’autres vecteurs d’exposition, tels que les « _task sequences »_ (scripts exécutés avec des identifiants intégrés), les « _collection variables »_ (qui peuvent stocker des mots de passe), ou encore les fichiers hébergés sur les « _distribution points »_. Ces derniers, accessibles via HTTP ou SMB, peuvent contenir des scripts PowerShell, certificats ou fichiers de configuration contenant des secrets, parfois accessibles sans aucune authentification si la configuration le permet.

Pour illustrer l’exploitation concrète des failles de SCCM, l’orateur présente **SCCM Secrets**, un outil développé dans le cadre de ses recherches. Celui-ci automatise la récupération des fichiers exposés sur les « distribution points » (scripts, certificats, configurations) accessibles parfois sans authentification. SCCM Secrets permet aussi d’enregistrer un faux client SCCM : soit en utilisant un compte machine compromis ou en profitant de la configuration d’approbation automatique. Une fois enregistré et approuvé, le faux client peut récupérer des politiques marquées comme sensibles, contenant des identifiants, des mots de passe… Le tout sans nécessiter de privilèges élevés.

Il décrit enfin comment ces attaques peuvent être réalisées via **NTLM relaying** : en interceptant une authentification légitime vers un point SCCM, un attaquant peut relayer cette authentification vers le serveur SCCM lui-même et ainsi accéder aux ressources protégées.

En conclusion, l’orateur insiste sur le fait qu’il ne s’agit pas de vulnérabilités techniques, mais de comportements par défaut ou de mauvaises configurations. Il recommande plusieurs mesures défensives simples mais souvent oubliées : désactiver l’approbation automatique, interdire l’accès anonyme, forcer l’usage du HTTPS avec mTLS, et activer la protection étendue contre les attaques par relai (EPA).

Une présentation claire et percutante, qui illustre parfaitement comment des configurations laxistes peuvent ouvrir la voie à des compromissions majeures.